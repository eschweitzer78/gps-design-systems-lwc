<template>
  <template if:true={definition}>
    <slot name="action"></slot>
    <div
      class="nds-section nds-is-open"
      if:true={_debug}
      onmousedown={toggleSection}
    >
      <h3 class="nds-section__title">
        <c-sf-gps-ds-osrt-button
          class="nds-button nds-button_icon nds-section__title-action"
          icon-name="utility:down"
          icon-url={iconUrl}
          icon-size="small"
          label="Debug"
          extraclass="nds-section__title-action"
        ></c-sf-gps-ds-osrt-button>
      </h3>
      <div
        aria-hidden="false"
        class="nds-section__content"
        id="expando-unique-id"
        if:true={isOpen}
      >
        <div class="nds-card">
          <div class="nds-text-heading_x-small">
            Total Execution time : {timeTaken}
          </div>
          <div class="nds-text-heading_x-small">
            Request JSON : {definition}
          </div>
          <pre data-value={value}>{debugData}</pre>
          <template if:true={error}> {errormessage} </template>
        </div>
      </div>
    </div>
  </template>
  <template if:true={isVlocityAction}>
    <template if:true={actionDetails}>
      <div class="nds-action">
        <template if:true={selectableAction}>
          <div class={actionContainerClass}>
            <template if:false={isBaseVersion}>
              <slot></slot>
            </template>
            <template if:true={isBaseVersion}>
              <div class={actionItemClass}>
                <c-sf-gps-ds-osrt-input
                  label={actionDetails.displayName}
                  theme="nds"
                  name="selectableAction"
                  type="checkbox"
                  checked={selectableActionVal}
                  onchange={fireSelectCard}
                  styles={getCheckboxStyles}
                >
                </c-sf-gps-ds-osrt-input>
              </div>
            </template>
          </div>
        </template>
        <template if:false={selectableAction}>
          <div class={actionContainerClass} onclick={performAction}>
            <template if:false={isBaseVersion}>
              <slot></slot>
            </template>
            <template if:true={isBaseVersion}>
              <!-- Link Type Action -->
              <a
                href="javascript:void(0)"
                data-action-focus
                if:false={_displayAsButton}
                class={actionItemClass}
              >
                <span
                  if:true={isIconRight}
                  class={actionTextClass}
                  style={labelStyle}
                  ><span if:false={_iconOnly}>{actionDetails.displayName}</span>
                </span>
                <div if:true={showIcon} class={iconDivClass}>
                  <span if:false={_iconOnly}>
                    <c-sf-gps-ds-osrt-icon
                      if:false={actionDetails.imageRef}
                      color={iconColor}
                      extraclass={iconClass}
                      size={iconSizeDef}
                      alternative-text={actionDetails.displayName}
                      icon-name={actionDetails.iconName}
                      theme="nds"
                      baseurl={iconurl}
                    >
                    </c-sf-gps-ds-osrt-icon>
                  </span>

                  <span if:true={_iconOnly}>
                    <c-sf-gps-ds-osrt-tooltip
                      if:false={actionDetails.imageRef}
                      theme="nds"
                      icon-size={iconSizeDef}
                      icon-fill={iconColor}
                      icon-url={iconUrl}
                      content={actionDetails.displayName}
                      arrowposition="bottom-left"
                      icon-name={actionDetails.iconName}
                      disable-tab="true"
                    >
                    </c-sf-gps-ds-osrt-tooltip>
                  </span>
                  <span
                    if:true={actionDetails.imageRef}
                    class={iconImgWrapperclass}
                  >
                    <img
                      class={iconClass}
                      src={actionDetails.imageRef}
                      alt={actionDetails.displayName}
                    />
                  </span>
                </div>
                <span
                  if:false={isIconRight}
                  class={actionTextClass}
                  style={labelStyle}
                  ><span if:false={_iconOnly}>{actionDetails.displayName}</span>
                </span>
              </a>
              <!-- Button Type Action -->
              <span if:true={_displayAsButton}>
                <template if:true={showIcon}>
                  <template if:true={isPopoverFlyout}>
                    <c-sf-gps-ds-osrt-button
                      if:false={_iconOnly}
                      theme="nds"
                      variant={buttonVariant}
                      label={actionDetails.displayName}
                      icon-name={actionDetails.iconName}
                      styles={styles}
                      icon-size={iconSizeDef}
                      icon-position="left"
                      icon-fill={iconColor}
                      aria-controls="popover-id"
                      aria-expanded={isFlyoutOpen}
                      data-action-focus
                    ></c-sf-gps-ds-osrt-button>
                  </template>
                  <template if:false={isPopoverFlyout}>
                    <c-sf-gps-ds-osrt-button
                      if:false={_iconOnly}
                      theme="nds"
                      variant={buttonVariant}
                      label={actionDetails.displayName}
                      icon-name={actionDetails.iconName}
                      styles={styles}
                      icon-size={iconSizeDef}
                      icon-position="left"
                      icon-fill={iconColor}
                      data-action-focus
                    ></c-sf-gps-ds-osrt-button>
                  </template>
                  <c-sf-gps-ds-osrt-tooltip
                    if:true={_iconOnly}
                    theme="nds"
                    icon-size={iconSizeDef}
                    icon-fill={iconColor}
                    arrowposition="bottom-left"
                    variant={buttonVariant}
                    content={actionDetails.displayName}
                    icon-name={actionDetails.iconName}
                  >
                  </c-sf-gps-ds-osrt-tooltip>
                </template>
                <template if:false={showIcon}>
                  <c-sf-gps-ds-osrt-button
                    if:true={isPopoverFlyout}
                    theme="nds"
                    variant={buttonVariant}
                    label={actionDetails.displayName}
                    styles={styles}
                    icon-size={iconSizeDef}
                    icon-fill={iconColor}
                    icon-position="left"
                    aria-controls="popover-id"
                    aria-expanded={isFlyoutOpen}
                    data-action-focus
                  ></c-sf-gps-ds-osrt-button>
                  <c-sf-gps-ds-osrt-button
                    if:false={isPopoverFlyout}
                    theme="nds"
                    variant={buttonVariant}
                    label={actionDetails.displayName}
                    styles={styles}
                    icon-size={iconSizeDef}
                    icon-fill={iconColor}
                    icon-position="left"
                    data-action-focus
                  ></c-sf-gps-ds-osrt-button>
                </template>
              </span>
            </template>
          </div>

          <div if:true={isPopoverFlyout}>
            <c-sf-gps-ds-osrt-popover
              class="popover-flyout"
              title="Test"
              theme="nds"
              icon-url={iconUrl}
              style="position: relative; top: 0rem; left: 0rem; right: 0rem"
              nubbinposition="top-left"
              size="full-width"
              id="popover-id"
              channel-name={channelName}
              onclose={closePopOver}
            >
              <div if:true={renderFlyout} slot="content">
                <template if:true={preloadFlyout}>
                  <slot name="flyout"></slot>
                </template>
              </div>
            </c-sf-gps-ds-osrt-popover>
          </div>
          <div if:true={isModalFlyout}>
            <c-sf-gps-ds-osrt-modal
              size="medium"
              onclose={onCloseModal}
              onopen={onOpenModal}
              class="actionFlyout"
              title={actionDetails.displayName}
              hideheader="true"
              hidefooter="true"
              channel-name={channelName}
            >
              <div
                if:true={renderFlyout}
                slot="content"
                class="nds-is-relative"
              >
                <template if:true={preloadFlyout}>
                  <slot name="flyout"></slot>
                </template>
              </div>
            </c-sf-gps-ds-osrt-modal>
          </div>

          <c-sf-gps-ds-osrt-navigate-action
            class="navigate-action"
            open-target-in={actionDetails.openUrl}
            target-params={actionDetails.targetParams}
            target-type={actionDetails.targetType}
            target-action={actionDetails.targetAction}
            target-id={actionDetails.targetId}
            data-name={actionDetails.displayName}
            replace={actionDetails.replace}
            target-relationship={actionDetails.targetRelationship}
            target-name={actionDetails.targetName}
            target-article-type={actionDetails.targetArticleType}
          >
          </c-sf-gps-ds-osrt-navigate-action>
        </template>
      </div>
    </template>
  </template>
</template>
