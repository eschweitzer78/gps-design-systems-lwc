<template>
  <div class={_errorClass}>
    <fieldset lwc:if={isCheckbox} class="slds-form-element">
      <legend lwc:if={label} class="slds-show slds-float_left">
        <abbr lwc:if={_required} class="slds-required" title={requiredLabel}
          >*</abbr
        >
        <span
          class="slds-form-element__legend slds-form-element__label slds-show_inline slds-float_none slds-var-p-top_xxx-small"
        >
          {label}
        </span>
      </legend>

      <span class="slds-clearfix"> {fieldLevelHelp} </span>
      <slot name="label"></slot>

      <div class={computedFormElementControlClassName}>
        <template
          for:each={_internalOptions}
          for:item="option"
          for:index="index"
        >
          <div key={option.id} class="slds-checkbox">
            <input
              id={option.id}
              data-sfgpsds-input
              type="checkbox"
              required={_required}
              disabled={_disabled}
              data-index={index}
              tabindex={tabIndex}
              name={option.name}
              aria-invalid={_isError}
              checked={option.selected}
              value={option.value}
              onfocus={handleFocus}
              onchange={handleChange}
              onkeydown={handleKeyDown}
            />
            <label
              class="slds-checkbox__label"
              data-index={index}
              for={option.id}
            >
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label slds-p-top_none">
                {option.label}
              </span>
            </label>
          </div>
        </template>
      </div>
    </fieldset>

    <fieldset lwc:elseif={isButton} class="slds-form-element">
      <legend class="slds-p-top_none slds-show slds-float_left">
        <abbr lwc:if={_required} class="slds-required" title={requiredLabel}
          >*</abbr
        >
        <span
          class="slds-form-element__legend slds-form-element__label slds-show_inline slds-float_none slds-var-p-top_xxx-small"
        >
          {label}
        </span>
      </legend>

      <span class="slds-clearfix"> {fieldLevelHelp} </span>
      <slot name="label"></slot>

      <div class={computedFormElementControlClassName}>
        <div class="slds-checkbox_button-group">
          <template
            for:each={_internalOptions}
            for:item="option"
            for:index="index"
          >
            <span key={option.id} class="slds-button slds-checkbox_button">
              <input
                id={option.id}
                data-sfgpsds-input
                type="checkbox"
                required={_required}
                disabled={_disabled}
                data-index={index}
                name={option.name}
                tabindex={tabIndex}
                aria-invalid={_isError}
                checked={option.selected}
                value={option.value}
                onfocus={handleFocus}
                onchange={handleChange}
              />
              <label
                class="slds-checkbox_button__label"
                data-index={index}
                for={option.id}
              >
                <span class="slds-checkbox_faux"> {option.label} </span>

                <div class="slds-checkbox-overlay"></div>
              </label>
            </span>
          </template>
        </div>
      </div>
    </fieldset>

    <fieldset lwc:elseif={isIcon} class="slds-form-element">
      <legend lwc:if={label} class="slds-p-top_none slds-show slds-float_left">
        <abbr lwc:if={_required} class="slds-required" title={requiredLabel}
          >*</abbr
        >
        <span
          class="slds-form-element__legend slds-form-element__label slds-show_inline slds-float_none slds-var-p-top_xxx-small"
        >
          {label}
        </span>
      </legend>

      <span class="slds-clearfix"> {fieldLevelHelp} </span>
      <slot name="label"></slot>

      <label class={computedCheckboxButtonLabelClassName} for="checkbox">
        <input
          id="checkbox"
          class="slds-assistive-text"
          data-sfgpsds-input
          name={name}
          disabled={_disabled}
          type="checkbox"
          tabindex={tabIndex}
          aria-invalid={_isError}
          checked={_isChecked}
          value={value}
          onfocus={handleFocus}
          onchange={handleChange}
        />
        <span class="slds-icon_container">
          <template lwc:if={_isChecked}>
            <svg
              aria-hidden="true"
              height="24"
              viewBox="0 -960 960 960"
              width="24"
            >
              <path
                d="M180-120q-24.75 0-42.375-17.625T120-180v-600q0-24.75 17.625-42.375T180-840h600q14 0 25.5 6t18.5 14l-44 44v-4H180v600h600v-343l60-60v403q0 24.75-17.625 42.375T780-120H180Zm281-168L239-510l42-42 180 180 382-382 42 42-424 424Z"
              />
            </svg>
          </template>
          <template lwc:else>
            <svg
              aria-hidden="true"
              height="24"
              viewBox="0 -960 960 960"
              width="24"
            >
              <path
                d="M180-120q-24 0-42-18t-18-42v-600q0-24 18-42t42-18h600q24 0 42 18t18 42v600q0 24-18 42t-42 18H180Zm0-60h600v-600H180v600Z"
              />
            </svg>
          </template>
        </span>
      </label>
    </fieldset>
  </div>

  <div lwc:if={_isError} class="slds-form-element__help" role="alert">
    {_errorMessage}
  </div>
</template>
