<template>
  <div if:false={isCustomLwc}>
    <div
      id="sf-gps-ds-uk-gov-masked-input-form-group"
      data-sfgpsds-input
      class={computedFormGroupClassName}
    >
      <div if:true={labelVisible} data-label="true">
        <h1 lwc:if={computedIsH1} class="govuk-label-wrapper">
          <label class={computedLabelClassName} for={inputId}>{label}</label>
        </h1>
        <h2 lwc:elseif={computedIsH2} class="govuk-label-wrapper">
          <label class={computedLabelClassName} for={inputId}>{label}</label>
        </h2>
        <h3 lwc:elseif={computedIsH3} class="govuk-label-wrapper">
          <label class={computedLabelClassName} for={inputId}>{label}</label>
        </h3>
        <label lwc:else class={computedLabelClassName} for={inputId}
          >{label}</label
        >
        <slot name="label"> </slot>
      </div>

      <div if:true={fieldLevelHelp} id="helper" class="govuk-hint">
        {fieldLevelHelp}
      </div>

      <!-- formula -->
      <div if:true={_isFormula}>
        <label class={computedLabelClassName} for={inputId}> {label} </label>

        <template lwc:if={computedHasPrefixOrSuffix}>
          <div class="govuk-input__wrapper">
            <div
              lwc:if={sfGpsDsPrefix}
              class="govuk-input__prefix"
              aria-hidden="true"
            >
              {sfGpsDsPrefix}
            </div>
            <input
              class="govuk-input"
              type="text"
              readonly
              disabled
              id={inputId}
              value={maskedValue}
              aria-describedby={computedAriaDescribedBy}
            />
            <div
              lwc:if={sfGpsDsSuffix}
              class="govuk-input__suffix"
              aria-hidden="true"
            >
              {sfGpsDsSuffix}
            </div>
          </div>
        </template>
        <template lwc:else>
          <input
            class="govuk-input"
            type="text"
            readonly
            disabled
            id={inputId}
            value={maskedValue}
            aria-describedby={computedAriaDescribedBy}
          />
        </template>
      </div>
      <!-- formula -->

      <div if:false={static} class={pretextClass}>
        <p
          if:true={sfGpsDsIsError}
          class="govuk-error-message"
          aria-live="assertive"
          role="alert"
          id="errorMessageBlock"
        >
          <span class="govuk-visually-hidden">{sfGpsDsErrorSrLabel}</span>
          {sfGpsDsErrorMessage}
        </p>

        <span if:true={pretext} class={pretextClass}>{pretext}</span>

        <template lwc:if={isCurrencySFlocale}>
          <template lwc:if={computedHasPrefixOrSuffix}>
            <div class="govuk-input__wrapper">
              <div
                lwc:if={sfGpsDsPrefix}
                class="govuk-input__prefix"
                aria-hidden="true"
              >
                {sfGpsDsPrefix}
              </div>
              <input
                if:true={isInput}
                class={computedInputClassName}
                id={inputId}
                tabindex={tabIndex}
                accesskey={accessKey}
                step={step}
                min={min}
                max={max}
                maxlength={maxLength}
                minlength={minLength}
                type={type}
                inputmode={inputmode}
                disabled={disabled}
                required={required}
                readonly={readOnly}
                placeholder={placeholder}
                aria-readonly={readOnly}
                aria-labelledby={ariaLabelledBy}
                aria-describedby={computedAriaDescribedBy}
                aria-label={ariaLabel}
                aria-invalid={sfGpsDsIsError}
                value={_currencyVal}
                onfocus={handleFocus}
                onblur={handleBlur}
                oninput={handleInput}
                onkeyup={handleKeyup}
                onchange={handleChange}
              />
              <div
                lwc:if={sfGpsDsSuffix}
                class="govuk-input__suffix"
                aria-hidden="true"
              >
                {sfGpsDsSuffix}
              </div>
            </div>
          </template>
          <template lwc:else>
            <input
              if:true={isInput}
              class={computedInputClassName}
              id={inputId}
              tabindex={tabIndex}
              accesskey={accessKey}
              step={step}
              min={min}
              max={max}
              maxlength={maxLength}
              minlength={minLength}
              type={type}
              inputmode={inputmode}
              disabled={disabled}
              required={required}
              readonly={readOnly}
              placeholder={placeholder}
              aria-readonly={readOnly}
              aria-labelledby={ariaLabelledBy}
              aria-describedby={computedAriaDescribedBy}
              aria-label={ariaLabel}
              aria-invalid={sfGpsDsIsError}
              value={_currencyVal}
              onfocus={handleFocus}
              onblur={handleBlur}
              oninput={handleInput}
              onkeyup={handleKeyup}
              onchange={handleChange}
            />
          </template>
        </template>

        <template lwc:else>
          <input
            if:true={isNumber}
            class="hiddenNumber slds-hide"
            required={required}
            min={min}
            max={max}
            step={step}
            type="number"
            value={value}
          />

          <template lwc:if={computedHasPrefixOrSuffix}>
            <div class="govuk-input__wrapper">
              <div
                lwc:if={sfGpsDsPrefix}
                class="govuk-input__prefix"
                aria-hidden="true"
              >
                {sfGpsDsPrefix}
              </div>
              <input
                if:true={isInput}
                class={computedInputClassName}
                id={inputId}
                tabindex={tabIndex}
                accesskey={accessKey}
                step={step}
                min={min}
                max={max}
                maxlength={maxLength}
                minlength={minLength}
                type={inputType}
                inputmode={inputmode}
                disabled={disabled}
                required={required}
                readonly={readOnly}
                aria-readonly={readOnly}
                placeholder={placeholder}
                aria-labelledby={ariaLabelledBy}
                aria-describedby={computedAriaDescribedBy}
                aria-label={ariaLabel}
                autocomplete={autocomplete}
                name={name}
                aria-invalid={sfGpsDsIsError}
                onfocus={handleFocus}
                onblur={handleBlur}
                oninput={handleInput}
                onkeyup={handleKeyup}
                onchange={handleChange}
              />
              <div
                lwc:if={sfGpsDsSuffix}
                class="govuk-input__suffix"
                aria-hidden="true"
              >
                {sfGpsDsSuffix}
              </div>
            </div>
          </template>
          <template lwc:else>
            <input
              if:true={isInput}
              class={computedInputClassName}
              id={inputId}
              tabindex={tabIndex}
              accesskey={accessKey}
              step={step}
              min={min}
              max={max}
              maxlength={maxLength}
              minlength={minLength}
              type={inputType}
              inputmode={inputmode}
              disabled={disabled}
              required={required}
              readonly={readOnly}
              aria-readonly={readOnly}
              placeholder={placeholder}
              aria-labelledby={ariaLabelledBy}
              aria-describedby={computedAriaDescribedBy}
              aria-label={ariaLabel}
              autocomplete={autocomplete}
              name={name}
              aria-invalid={sfGpsDsIsError}
              onfocus={handleFocus}
              onblur={handleBlur}
              oninput={handleInput}
              onkeyup={handleKeyup}
              onchange={handleChange}
            />
          </template>
        </template>

        <span if:true={posttext} class="sfgpsds-form-element__addon">
          {posttext}
        </span>
      </div>

      <!-- shifted testing static one level up to avoid the empty div -->
      <div if:true={static} class="slds-grid">
        <div class="slds-form-element__static">{maskedValue}</div>
      </div>

      <span if:true={inlineHelp} class="slds-form-element__static">
        {inlineHelp}
      </span>
    </div>
  </div>
</template>
