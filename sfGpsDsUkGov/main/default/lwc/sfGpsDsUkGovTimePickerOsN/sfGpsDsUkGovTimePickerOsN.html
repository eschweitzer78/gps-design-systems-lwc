<template>
  <div class="sfgpsds-form-element">
    <div
      id="sf-gps-ds-uk-gov-time-picker-form-group"
      data-sf-gps-uk-gov-error-input
      class={computedFormGroupClassName}
    >
      <div data-label="true">
        <label
          lwc:if={hideFormGroup}
          class={computedLabelClassName}
          style={styleProperties.label.styles}
          for="time-input"
        >
          {label}
        </label>

        <h3 lwc:else class="govuk-label-wrapper">
          <label
            class={computedLabelClassName}
            style={styleProperties.label.styles}
            for="time-input"
          >
            {label}
          </label>
        </h3>
        <slot name="label"> </slot>
      </div>

      <div if:true={fieldLevelHelp} id="helper" class="govuk-hint">
        {fieldLevelHelp}
      </div>

      <p
        if:true={isError}
        class="govuk-error-message"
        aria-live="assertive"
        role="alert"
        id="errorMessageBlock"
      >
        <span class="govuk-visually-hidden">{errorSrLabel}</span>{_errorMessage}
      </p>

      <div class="sfgpsds-form-element__control sfgpsds-predictive">
        <div class="sfgpsds-combobox_container">
          <div
            class="sfgpsds-combobox sfgpsds-dropdown-trigger sfgpsds-dropdown-trigger_click"
            onblur={handleComponentLosesFocus}
          >
            <div class="sfgpsds-combobox__form-element" role="none">
              <input
                class={computedInputClassName}
                style={styleProperties.value.styles}
                autocomplete="off"
                id="time-input"
                role="combobox"
                type="text"
                name={name}
                disabled={disabled}
                required={required}
                readonly={readOnly}
                placeholder={placeholder}
                tabindex={tabIndex}
                aria-expanded="false"
                aria-haspopup="listbox"
                aria-autocomplete="both"
                aria-describedby={computedAriaDescribedBy}
                aria-controls="time_picker_ul"
                aria-label={ariaLabel}
                aria-readonly={readOnly}
                aria-invalid={isAriaInvalid}
                value={_displayValue}
                onblur={showLookup}
                onchange={onInputChange}
                onkeydown={handleKeyboardEvent}
                onkeyup={handleKeyUp}
                onmousedown={showLookup}
              />
            </div>

            <div
              id="dropdown"
              class="sfgpsds-dropdown sfgpsds-dropdown_fluid sfgpsds-dropdown_length-5 sfgpsds-predictive__list"
              role="listbox"
            >
              <ul
                class="sfgpsds-listbox sfgpsds-listbox_vertical"
                id="time_picker_ul"
                role="presentation"
                onmousedown={scrollerClickOnList}
              >
                <template
                  for:each={_safeOptions}
                  for:item="item"
                  for:index="index"
                >
                  <li key={item.id} class="sfgpsds-listbox__item">
                    <div
                      id={item.id}
                      data-index={index}
                      data-selected={item.selected}
                      data-val={item.value}
                      data-timepicker-option
                      role="option"
                      aria-selected={item.selected}
                      class="sfgpsds-media sfgpsds-media_small sfgpsds-media_center sfgpsds-listbox__option sfgpsds-listbox__option_plain"
                      onmousedown={selectOption}
                    >
                      <span
                        class="sfgpsds-media__figure slds-listbox__option-icon"
                      >
                        <span
                          if:true={item.selected}
                          class="sfgpsds-icon-small"
                          aria-hidden="true"
                        >
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="#fff"
                            height="14"
                            width="14"
                            viewBox="0 96 960 960"
                          >
                            <path
                              d="M378 810 154 586l43-43 181 181 384-384 43 43-427 427Z"
                            />
                          </svg>
                        </span>
                      </span>

                      <span class="sfgpsds-media__body">
                        <span
                          class="sfgpsds-listbox__option-text"
                          title={item.value}
                        >
                          {item.value}
                        </span>
                      </span>
                    </div>
                  </li>
                </template>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
