<!-- sldsValidatorIgnore -->
<template>
  <!-- Header/Label -->

  <div class="nsw-table">
    <table>
      <!-- Table Header -->
      <thead lwc:if={_isFirstIndex}>
        <tr>
          <th>
            <span class="sr-only">Error</span>
          </th>
          <template
            for:each={_tableLabels}
            for:item="dvItem"
            for:index="dvIndex"
          >
            <th key={dvItem.lwcId} class={dvItem.cls} width={dvItem.tableWidth}>
              {dvItem.label}
            </th>
          </template>
        </tr>
      </thead>

      <!-- Table is always visible -->
      <template lwc:if={_hasChildren}>
        <tbody
          if:false={_isEditing}
          class="omni-edit-block-fs-row"
          role="button"
          onclick={edit}
          aria-describedby={computedErrorTextId}
          aria-invalid={isInvalid}
        >
          <tr>
            <td>
              <template lwc:if={isInvalid}>
                <span class="sr-only" id="fs-text-error">
                  {allCustomLabelsUtil.OmniEditBlockRowError}
                </span>
                <span
                  aria-hidden="true"
                  class="nsw-form__required"
                  title={requiredLabel}
                >
                </span>
                <span class="sr-only"> ({requiredLabel})</span>
              </template>
            </td>

            <td>
              <template
                for:each={_displayValues}
                for:item="dvItem"
                for:index="dvIndex"
              >
                <div key={dvItem.lwcId} class={dvItem.cls}>
                  <template lwc:if={dvItem.isCheckbox}>
                    <div>
                      <input
                        id={dvItem.checkboxId}
                        type="checkbox"
                        checked={dvItem.value}
                        disabled
                        class="nsw-form__checkbox-input"
                      />
                      <label
                        for={dvItem.checkboxId}
                        class="nsw-form__checkbox-label"
                      >
                        <span lwc:if={dvItem.value} class="sr-only"
                          >Selected</span
                        >
                        <span lwc:else class="sr-only">Unselected</span>
                      </label>
                    </div>
                  </template>
                  <template lwc:else> {dvItem.value} </template>
                </div>
              </template>
            </td>

            <!--</div>-->

            <td>
              <button
                lwc:if={_allowDelete}
                aria-label={allCustomLabelsUtil.OmniDelete}
                data-remove-button
                class="nsw-icon-button sfgpsds-au-nsw-editblock__delete"
                onclick={remove}
              >
                <span
                  class="material-icons nsw-material-icons"
                  aria-hidden="true"
                >
                  delete
                </span>
              </button>
            </td>
          </tr>
        </tbody>
      </template>
    </table>
  </div>

  <!-- Inline Editing -->
  <div class={editClassName}>
    <article class="sfgpsds-au-nsw-editblock--fs">
      <fieldset>
        <slot></slot>
        <div class="nsw-list nsw-list--8 nsw-p-top-sm">
          <button onclick={cancel} class="nsw-button nsw-button--dark-outline">
            {allCustomLabelsUtil.OmnicancelLabel}
          </button>

          <button
            onclick={save}
            disabled={isPageLoading}
            class="nsw-button nsw-button--dark-outline"
          >
            {allCustomLabelsUtil.OmniConfigProdModalOk}
          </button>
        </div>
      </fieldset>
    </article>
  </div>

  <!-- Add Button -->
  <div if:true={showAdd} class="nsw-m-top-sm">
    <button
      type="button"
      class="nsw-button nsw-button--dark-outline editblock-new"
      onclick={handleAdd}
    >
      {_newLabel}
    </button>
  </div>

  <!-- Spinner -->
  <c-sf-gps-ds-au-nsw-loader-os
    lwc:if={isPageLoading}
    label={allCustomLabelsUtil.OmniSpinnerTextLoading}
    size="md"
  >
  </c-sf-gps-ds-au-nsw-loader-os>
</template>
