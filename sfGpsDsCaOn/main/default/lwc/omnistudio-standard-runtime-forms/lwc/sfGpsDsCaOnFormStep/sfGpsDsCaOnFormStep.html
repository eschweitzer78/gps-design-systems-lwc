<!-- sldsValidatorIgnore -->
<!--
  Ontario Design System - Step Component for OmniStudio
  
  Provides step container with navigation buttons.
  Uses Ontario DS button styling for consistent appearance.
  
  Compliance:
  - LWR: Compatible (uses slot for content)
  - LWS: Compatible (no restricted APIs)
  - Ontario DS: Uses Ontario button classes
  - WCAG 2.1 AA / AODA: 
    - Skip link for keyboard users to bypass form content
    - Step heading with aria-live for announcements
    - Focus management on step change
    - Keyboard accessible buttons
    - Logical focus order
    - Error summary region for validation feedback
-->
<template>
  <template lwc:if={jsonDef.bAccordionActive}>
    <div class="sfgpsdscaon-step" role="region" aria-label={stepAriaLabel}>
      <!-- Skip link for keyboard users - AODA requirement -->
      <a
        href="#step-navigation"
        class="sfgpsdscaon-step__skip-link ontario-show-for-sr"
        onfocus={handleSkipLinkFocus}
        onblur={handleSkipLinkBlur}
      >
        Skip to navigation buttons
      </a>

      <!-- Step heading -->
      <h2
        lwc:if={mergedLabel}
        id="step-heading"
        class="sfgpsdscaon-step__heading"
        tabindex="-1"
      >
        {mergedLabel}
      </h2>

      <!-- Screen reader announcement for step change -->
      <div
        class="ontario-show-for-sr"
        aria-live="polite"
        aria-atomic="true"
        role="status"
      >
        <span lwc:if={stepAnnouncement}>{stepAnnouncement}</span>
      </div>

      <hr class="sfgpsdscaon-step__separator" aria-hidden="true" />

      <!-- Error summary region - appears when validation errors exist -->
      <div
        lwc:if={hasValidationErrors}
        class="sfgpsdscaon-step__error-summary ontario-callout ontario-callout--error"
        role="alert"
        aria-live="assertive"
        tabindex="-1"
      >
        <h3 class="ontario-callout__title ontario-h5">
          There are errors on this page
        </h3>
        <p>
          Please review and correct the highlighted fields before continuing.
        </p>
      </div>

      <!-- Step content (slot for child elements) -->
      <div class="sfgpsdscaon-step__content" id="step-content">
        <slot></slot>
      </div>

      <!-- Navigation buttons - skip link target -->
      <nav
        lwc:if={computedShowSep}
        id="step-navigation"
        class="sfgpsdscaon-step__actions"
        aria-label="Step navigation"
      >
        <!-- Back button -->
        <div lwc:if={showPrev} class="sfgpsdscaon-step__back">
          <c-sf-gps-ds-ca-on-back-button
            text={mergedPreviousLabel}
            disabled={disabledButtons}
            onclick={handleBack}
            aria-describedby="step-heading"
          >
          </c-sf-gps-ds-ca-on-back-button>
        </div>

        <!-- Primary actions -->
        <div class="sfgpsdscaon-step__primary-actions">
          <!-- Save for later button -->
          <button
            lwc:if={showSave}
            type="button"
            class="ontario-button ontario-button--secondary"
            disabled={disabledButtons}
            onclick={handleSave}
          >
            {mergedSaveLabel}
          </button>

          <!-- Next/Continue button -->
          <button
            lwc:if={showNext}
            type="button"
            class="ontario-button ontario-button--primary"
            disabled={disabledButtons}
            onclick={handleNext}
          >
            {mergedNextLabel}
          </button>
        </div>
      </nav>
    </div>
  </template>
</template>
