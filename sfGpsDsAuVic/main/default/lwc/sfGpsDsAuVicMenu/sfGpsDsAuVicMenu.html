<template lwc:render-mode="light">
  <div
    class={computedClass}
    data-depth={depth}
    data-vpos={computedRootVerticalDepth}
    data-visibledepth={computedVisibleDepth}
  >
    <div class="rpl-menu__inner">
      <div class="rpl-menu__inner_root">
        <c-sf-gps-ds-au-vic-quick-exit
          if:true={computedShowQuickExit}
          class="rpl-menu__quickexit"
          text={quickExitLabel}
          escape-url={quickExitTarget}
        >
        </c-sf-gps-ds-au-vic-quick-exit>

        <div class="rpl-menu__column">
          <div class="rpl-menu__header">
            <button
              if:true={computedShowCloseMenu}
              class="rpl-menu__back"
              onclick={handleVerticalGoBack}
            >
              <!-- TODO onfocus? onclick={handleVerticalGoBack} -->
              <c-sf-gps-ds-au-vic-icon
                symbol="left"
                color="white"
              ></c-sf-gps-ds-au-vic-icon>
              <span class="rpl-visually-hidden"
                >Close {title} and return to
              </span>
              <span>{backTitle}</span>
            </button>

            <a
              if:true={computedShowMenuHeading}
              class={computedMenuHeadingClass}
              href={parent.url}
              target={parent.target}
              >{parent.text}</a
            >
          </div>

          <ul class={computedMenuItemsClass}>
            <!-- Home button -->
            <li if:true={computedShowMenuItem} class="rpl-menu__item">
              <a class="rpl-menu__item-link rpl-menu__item-link--home" href="/">
                <span>
                  <!-- style="margin-right: 0.5rem; TODO style to fix lwc scoping issue with css -->
                  <c-sf-gps-ds-au-vic-icon
                    symbol="menu_home"
                    color="white"
                  ></c-sf-gps-ds-au-vic-icon> </span
                >Home
              </a>
            </li>

            <!-- Parent link -->
            <li if:true={computedShowParentLink} class="rpl-menu__item">
              <a
                class="rpl-menu__item-link rpl-menu__item-link--parent"
                href={parent.url}
                >{parent.text}
              </a>
            </li>

            <!-- Menu items -->
            <template for:each={_menu} for:item="list" for:index="index">
              <!-- decoratedMenu -->
              <li key={list.key} class={list.liClass}>
                <!-- removed onfocus={handleItemFocus} -->
                <a
                  if:true={list.displayAsLink}
                  class="rpl-menu__item-link"
                  href=""
                  target={list.target}
                  onclick={handleItemClick}
                  data-menu-index={list.index}
                  >{list.text}</a
                >

                <!-- removed onfocus={handleItemFocus}-->
                <!-- If there are no children or we have reached the menu depth of 3
                     display menu item as a link -->
                <button
                  if:false={list.displayAsLink}
                  class={list.buttonClass}
                  onclick={handleMenuLinkClick}
                  aria-expanded={list.open}
                  aria-controls={list.index}
                  data-menu-index={list.index}
                >
                  <span>{list.text}</span>
                  <c-sf-gps-ds-au-vic-icon
                    symbol={list.parentIcon}
                    color="white"
                  >
                  </c-sf-gps-ds-au-vic-icon>
                </button>

                <!-- removed onfocus={handleInnerItemFocus} -->
                <c-sf-gps-ds-au-vic-menu
                  if:false={list.displayAsLink}
                  id={list.index}
                  menu={list.children}
                  depth={computedSubMenuDepth}
                  open={list.open}
                  layout={layout}
                  title={list.text}
                  quick-exit-label={quickExitLabel}
                  quick-exit-target={quickExitTarget}
                  back-title={title}
                  shared-control={sharedControl}
                  parent={list}
                  onmenuchange={handleInnerMenuChange}
                  onback={handleInnerMenuBack}
                  onclosemenu={handleCloseMenu}
                  onopenmenu={handleOpenMenu}
                  onnavigate={handleNavigate}
                  data-menu-index={list.index}
                  index={list.index}
                >
                </c-sf-gps-ds-au-vic-menu>
              </li>
            </template>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>
